<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Web Viewer for KitKat 4.4</title>
    <style type="text/css">
        /* Basic reset for older browsers */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: Arial, sans-serif;
            -webkit-text-size-adjust: 100%; /* Prevent font scaling in landscape */
        }
        
        /* Container for the webview */
        #webview-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        /* Loading indicator */
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
        }
        
        /* Address bar styling */
        #address-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: #f0f0f0;
            padding: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 100;
            display: flex;
        }
        
        #address-input {
            flex: 1;
            height: 30px;
            padding: 0 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 14px;
        }
        
        #go-button {
            width: 50px;
            height: 30px;
            margin-left: 5px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 14px;
        }
        
        /* Fallback message */
        #fallback-message {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            max-width: 80%;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Simple address bar -->
    <div id="address-bar">
        <input type="text" id="address-input" placeholder="Enter URL (e.g., http://example.com)" />
        <button id="go-button">GO</button>
    </div>
    
    <!-- WebView container (will be replaced by native WebView in Android app) -->
    <div id="webview-container">
        <iframe id="webview" style="width:100%; height:100%; border:none;"></iframe>
    </div>
    
    <!-- Loading indicator -->
    <div id="loading">Loading...</div>
    
    <!-- Fallback message for unsupported content -->
    <div id="fallback-message">
        This content cannot be displayed in your browser. Please try a different website.
    </div>
    
    <script type="text/javascript">
        // Feature detection for KitKat compatibility
        function isKitKatCompatible() {
            try {
                // Check for features that might not be available in KitKat's WebView
                if (typeof Promise === 'undefined') return false;
                if (typeof Array.prototype.forEach === 'undefined') return false;
                if (typeof document.querySelector === 'undefined') return false;
                return true;
            } catch (e) {
                return false;
            }
        }
        
        // Initialize the page
        function init() {
            if (!isKitKatCompatible()) {
                showFallbackMessage();
                return;
            }
            
            // Get DOM elements
            var addressInput = document.getElementById('address-input');
            var goButton = document.getElementById('go-button');
            var webview = document.getElementById('webview');
            var loading = document.getElementById('loading');
            
            // Load a default page
            loadUrl('http://example.com');
            
            // Handle GO button click
            goButton.addEventListener('click', function() {
                var url = addressInput.value.trim();
                if (url) {
                    if (!url.startsWith('http://') && !url.startsWith('https://')) {
                        url = 'http://' + url;
                    }
                    loadUrl(url);
                }
            });
            
            // Handle Enter key in address bar
            addressInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    goButton.click();
                }
            });
            
            // Show loading when page is loading
            webview.addEventListener('loadstart', function() {
                loading.style.display = 'block';
            });
            
            // Hide loading when page is loaded
            webview.addEventListener('load', function() {
                loading.style.display = 'none';
            });
            
            // Handle errors
            webview.addEventListener('error', function() {
                loading.style.display = 'none';
                showFallbackMessage();
            });
        }
        
        // Load a URL into the iframe
        function loadUrl(url) {
            try {
                document.getElementById('address-input').value = url;
                document.getElementById('webview').src = url;
                document.getElementById('fallback-message').style.display = 'none';
            } catch (e) {
                showFallbackMessage();
            }
        }
        
        // Show fallback message
        function showFallbackMessage() {
            document.getElementById('fallback-message').style.display = 'block';
        }
        
        // Start the app when DOM is ready
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>